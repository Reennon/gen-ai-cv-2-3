# gen-ai-cv-lab-2

This repository implements a modular training pipeline for generative models on the CIFAR-10 dataset. It supports Autoencoders, Variational Autoencoders (VAEs), Generative Adversarial Networks (GANs), and Normalizing Flows. The pipeline is designed for flexibility, reproducibility, and scalability, with robust logging and visualization tools.

### Training Notebooks:

#### Diffusion:
Our diffusion model employs a Denoising Diffusion Probabilistic Model (DDPM) framework with deterministic sampling via Denoising Diffusion Implicit Models (DDIM). 
Unlike autoencoders that extract features from the original image, the diffusion model progressively adds noise to images and then learns to reverse this process to recover high-quality samples. 
By using a time-conditioned CNN enhanced with residual blocks, batch normalization, and self-attention layers, the model effectively captures the complex data distribution.
The training pipeline is modular, allowing for easy integration with our robust logging and visualization tools, ensuring reproducible and scalable experiments (which easy to modify if needed, since all logs are real-time in wandb).

```notebooks/diffusion.ipynb```
link to wandb (please wait a few moments it's taking a while to load all of those images):
https://wandb.ai/rkovalchuk/CIFAR10-Training?nw=nwuserrkovalch (It's named CIFAR-10 but actually it's MNIST repo)

Related files:
- `src/models/diffusion` - Basic PyTorch Model is here
- `src/training/diffusion_module` - PyTorch Lightning Module for Training and Monitoring is here

### FAQ

##### How to open in Colab?
> There's button at the beginning of each notebook for each model
##### How to download a model?
> There's an artifact with best model saved for each run in wandb for each model architecture

##### How to install dependencies in Google Colab?
> Follow those two steps:
```shell
!git clone https://github.com/Reennon/gen-ai-cv-lab-1.git
!pip install -r requirements.txt
```
##### For poetry setup:
```shell
poetry install
```

##### Generated Image Comparison

---

### **Image Comparison Table**

| **Original Image**                                  | **Diffusion**                                                | **VAE**                                      | **GAN**                                     | **Normalizing Flow**                         |
|-----------------------------------------------------|--------------------------------------------------------------|----------------------------------------------|---------------------------------------------|----------------------------------------------|
| ![diffusion-original.png](images%2Fdiffusion-original.png) | ![diffusion-30-epochs.png](images%2Fdiffusion-30-epochs.png) | ![vae.png](images%2Fvae.png) | ![gan.png](images%2Fgan.png) | ![norm_flow.png](images%2Fnorm_flow.png) |

* Gan has been trained for 600 epochs, and Normalized Flow seems underfitted, but superbly show a general state of the things, how the images were generated by such type of model

---

### **How to Fill the Table**

1. **Original Image**:
   - Use a batch of original images from the CIFAR-10 dataset validation set.
   - Save the combined batch of images as `original.png` and `original2.png`.

2. **Reconstructed/Generated Images**:
   - Save reconstructed or generated

## Directory Structure
```text
gen-ai-cv-lab-1/
│
├── data/                     # CIFAR-10 dataset storage
├── notebooks/                # Notebooks for each model
│   ├── autoencoder.ipynb     # Autoencoder training and visualization
│   ├── gan.ipynb             # GAN training and visualization
│   ├── gan_wider.ipynb       # Wider GAN architecture experiments
│   ├── norm_flow.ipynb       # Normalizing Flow experiments
│   └── vae.ipynb             # VAE training and visualization
├── params/                   # Model-specific YAML configuration files
│   ├── autoencoder.yml
│   ├── gan.yml
│   ├── norm_flow.yml
│   └── vae.yml
├── src/                      # Source code
│   ├── models/               # Model definitions
│   │   ├── autoencoder.py
│   │   ├── base_model.py     # Shared functionality for all models
│   │   ├── gan.py
│   │   ├── norm_flow.py
│   │   └── vae.py
│   ├── training/             # Training and evaluation logic
│   │   └── trainer.py
│   └── visualization/        # Visualization tools
│       ├── base_visualizer.py
│       ├── gan_visualizer.py
│       └── vae_visualizer.py
├── .env                      # Environment variables
├── .gitignore
├── README.md                 # Project documentation
├── requirements.txt          # Python dependencies
├── sample.env                # Example environment variable file
└── pyproject.toml            # Poetry configuration
```
